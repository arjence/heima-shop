{"version":3,"file":"address-form.js","sources":["../../../../../src/packageMember/address-form/address-form.vue","../../../../../uniPage:/cGFja2FnZU1lbWJlclxhZGRyZXNzLWZvcm1cYWRkcmVzcy1mb3JtLnZ1ZQ"],"sourcesContent":["<script setup lang=\"ts\">\nimport { ref } from 'vue'\nimport {\n  postMemberAddressApi,\n  getMemberAddressByIdApi,\n  putMemberAddressByIdApi,\n} from '@/services/address'\nimport { onLoad } from '@dcloudio/uni-app'\n\nconst props = defineProps<{\n  id: string\n}>()\n\n// 表单数据\nconst form = ref({\n  receiver: '', // 收货人\n  contact: '', // 联系方式\n  fullLocation: '', // 省市区(前端展示)\n  provinceCode: '', // 省份编码(后端参数)\n  cityCode: '', // 城市编码(后端参数)\n  countyCode: '', // 区/县编码(后端参数)\n  address: '', // 详细地址\n  isDefault: 0, // 默认地址，1为是，0为否\n})\n\nconst formRef = ref<UniHelper.UniFormsInstance>()\n\nconst formRules: UniHelper.UniFormsRules = {\n  receiver: {\n    rules: [{ required: true, errorMessage: '收货人名称不能为空' }],\n  },\n  contact: {\n    rules: [\n      { required: true, errorMessage: '联系方式不能为空' },\n      { pattern: /^1[3-9]\\d{9}$/, errorMessage: '请输入正确的联系方式' },\n    ],\n  },\n  fullLocation: {\n    rules: [{ required: true, errorMessage: '地区信息不能为空' }],\n  },\n  address: {\n    rules: [{ required: true, errorMessage: '详细地址不能为空' }],\n  },\n}\n\nconst getMemberAddressDataById = async () => {\n  const { result } = await getMemberAddressByIdApi(props.id)\n  form.value = result\n}\n\nconst onRegionChange: UniHelper.RegionPickerOnChange = (e) => {\n  form.value.fullLocation = e.detail.value.join(' ')\n  form.value.provinceCode = e.detail.code![0]\n  form.value.cityCode = e.detail.code![1]\n  form.value.countyCode = e.detail.code![2]\n  // const [provinceCode, cityCode, countyCode] = e.detail.code!\n  // Object.assign(form.value, provinceCode, cityCode, countyCode)\n}\n\nconst onSwitchChange: UniHelper.SwitchOnChange = (e) => {\n  form.value.isDefault = e.detail.value ? 1 : 0\n}\n\nconst onSubmit = async () => {\n  await formRef.value?.validate?.()\n  //编辑\n  if (props.id) {\n    await putMemberAddressByIdApi(props.id, form.value)\n  } else {\n    //新增\n    await postMemberAddressApi(form.value)\n  }\n  uni.showToast({ icon: 'success', title: props.id ? '编辑成功' : '新增成功' })\n  setTimeout(() => {\n    uni.navigateBack()\n  }, 500)\n}\n\nonLoad(() => {\n  if (props.id) {\n    getMemberAddressDataById()\n    uni.setNavigationBarTitle({ title: '修改地址' })\n  } else {\n    uni.setNavigationBarTitle({ title: '新增地址' })\n  }\n})\n</script>\n\n<template>\n  <view class=\"content\">\n    <uni-forms ref=\"formRef\" :modelValue=\"form\" :rules=\"formRules\">\n      <!-- 表单内容 -->\n      <uni-forms-item class=\"form-item\" name=\"receiver\">\n        <text class=\"label\">收货人</text>\n        <input class=\"input\" placeholder=\"请填写收货人姓名\" v-model=\"form.receiver\" />\n      </uni-forms-item>\n      <uni-forms-item class=\"form-item\" name=\"contact\">\n        <text class=\"label\">手机号码</text>\n        <input class=\"input\" placeholder=\"请填写收货人手机号码\" v-model=\"form.contact\" />\n      </uni-forms-item>\n      <uni-forms-item class=\"form-item\" name=\"fullLocation\">\n        <text class=\"label\">所在地区</text>\n        <picker class=\"picker\" mode=\"region\" :value=\"form.fullLocation\" @change=\"onRegionChange\">\n          <view v-if=\"form.fullLocation\">{{ form.fullLocation }}</view>\n          <view v-else class=\"placeholder\">请选择省/市/区(县)</view>\n        </picker>\n      </uni-forms-item>\n      <uni-forms-item class=\"form-item\" name=\"address\">\n        <text class=\"label\">详细地址</text>\n        <input class=\"input\" placeholder=\"街道、楼牌号等信息\" v-model=\"form.address\" />\n      </uni-forms-item>\n      <uni-forms-item class=\"form-item\">\n        <label class=\"label\">设为默认地址</label>\n        <switch\n          class=\"switch\"\n          color=\"#27ba9b\"\n          :checked=\"form.isDefault === 1\"\n          @change=\"onSwitchChange\"\n        />\n      </uni-forms-item>\n    </uni-forms>\n  </view>\n  <!-- 提交按钮 -->\n  <button class=\"button\" @tap=\"onSubmit\">保存并使用</button>\n</template>\n\n<style lang=\"scss\">\npage {\n  background-color: #f4f4f4;\n}\n\n.content {\n  margin: 20rpx 20rpx 0;\n  padding: 0 20rpx;\n  border-radius: 10rpx;\n  background-color: #fff;\n\n  .form-item,\n  .uni-forms-item {\n    display: flex;\n    align-items: center;\n    min-height: 96rpx;\n    padding: 25rpx 10rpx 40rpx;\n    background-color: #fff;\n    font-size: 28rpx;\n    border-bottom: 1rpx solid #ddd;\n    position: relative;\n    margin-bottom: 0;\n\n    /**调整 uni-forms 样式*/\n    .uni-forms-item__content {\n      display: flex;\n    }\n\n    .uni-forms-item__error {\n      margin-left: 200rpx;\n    }\n\n    &:last-child {\n      border: none;\n    }\n\n    .label {\n      width: 200rpx;\n      color: #333;\n    }\n\n    .input {\n      flex: 1;\n      display: block;\n      height: 46rpx;\n    }\n\n    .switch {\n      position: absolute;\n      right: -20rpx;\n      transform: scale(0.8);\n    }\n\n    .picker {\n      flex: 1;\n    }\n\n    .placeholder {\n      color: #808080;\n    }\n  }\n}\n\n.button {\n  height: 80rpx;\n  margin: 30rpx 20rpx;\n  color: #fff;\n  border-radius: 80rpx;\n  font-size: 30rpx;\n  background-color: #27ba9b;\n}\n</style>\n","import MiniProgramPage from 'D:/Arjence/学习/uniapp/heima-shop/src/packageMember/address-form/address-form.vue'\nwx.createPage(MiniProgramPage)"],"names":["ref","getMemberAddressByIdApi","putMemberAddressByIdApi","postMemberAddressApi","uni","onLoad"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;AAcA,UAAM,OAAOA,cAAAA,IAAI;AAAA,MACf,UAAU;AAAA;AAAA,MACV,SAAS;AAAA;AAAA,MACT,cAAc;AAAA;AAAA,MACd,cAAc;AAAA;AAAA,MACd,UAAU;AAAA;AAAA,MACV,YAAY;AAAA;AAAA,MACZ,SAAS;AAAA;AAAA,MACT,WAAW;AAAA;AAAA,IAAA,CACZ;AAED,UAAM,UAAUA,cAAAA;AAEhB,UAAM,YAAqC;AAAA,MACzC,UAAU;AAAA,QACR,OAAO,CAAC,EAAE,UAAU,MAAM,cAAc,aAAa;AAAA,MACvD;AAAA,MACA,SAAS;AAAA,QACP,OAAO;AAAA,UACL,EAAE,UAAU,MAAM,cAAc,WAAW;AAAA,UAC3C,EAAE,SAAS,iBAAiB,cAAc,aAAa;AAAA,QACzD;AAAA,MACF;AAAA,MACA,cAAc;AAAA,QACZ,OAAO,CAAC,EAAE,UAAU,MAAM,cAAc,YAAY;AAAA,MACtD;AAAA,MACA,SAAS;AAAA,QACP,OAAO,CAAC,EAAE,UAAU,MAAM,cAAc,YAAY;AAAA,MACtD;AAAA,IAAA;AAGF,UAAM,2BAA2B,YAAY;AAC3C,YAAM,EAAE,OAAO,IAAI,MAAMC,iBAAA,wBAAwB,MAAM,EAAE;AACzD,WAAK,QAAQ;AAAA,IAAA;AAGT,UAAA,iBAAiD,CAAC,MAAM;AAC5D,WAAK,MAAM,eAAe,EAAE,OAAO,MAAM,KAAK,GAAG;AACjD,WAAK,MAAM,eAAe,EAAE,OAAO,KAAM,CAAC;AAC1C,WAAK,MAAM,WAAW,EAAE,OAAO,KAAM,CAAC;AACtC,WAAK,MAAM,aAAa,EAAE,OAAO,KAAM,CAAC;AAAA,IAAA;AAKpC,UAAA,iBAA2C,CAAC,MAAM;AACtD,WAAK,MAAM,YAAY,EAAE,OAAO,QAAQ,IAAI;AAAA,IAAA;AAG9C,UAAM,WAAW,YAAY;;AACrB,cAAA,mBAAQ,UAAR,mBAAe,aAAf;AAEN,UAAI,MAAM,IAAI;AACZ,cAAMC,iBAAwB,wBAAA,MAAM,IAAI,KAAK,KAAK;AAAA,MAAA,OAC7C;AAEC,cAAAC,iBAAA,qBAAqB,KAAK,KAAK;AAAA,MACvC;AACIC,oBAAAA,MAAA,UAAU,EAAE,MAAM,WAAW,OAAO,MAAM,KAAK,SAAS,OAAA,CAAQ;AACpE,iBAAW,MAAM;AACfA,sBAAA,MAAI,aAAa;AAAA,SAChB,GAAG;AAAA,IAAA;AAGRC,kBAAAA,OAAO,MAAM;AACX,UAAI,MAAM,IAAI;AACa;AACzBD,sBAAAA,MAAI,sBAAsB,EAAE,OAAO,OAAQ,CAAA;AAAA,MAAA,OACtC;AACLA,sBAAAA,MAAI,sBAAsB,EAAE,OAAO,OAAQ,CAAA;AAAA,MAC7C;AAAA,IAAA,CACD;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACpFD,GAAG,WAAW,eAAe;"}