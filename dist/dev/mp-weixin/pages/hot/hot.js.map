{"version":3,"file":"hot.js","sources":["../../../../../src/pages/hot/hot.vue","../../../../../uniPage:/cGFnZXMvaG90L2hvdC52dWU"],"sourcesContent":["<script setup lang=\"ts\">\nimport type { HotResult, SubTypes } from '@/types/hot'\n\nimport { ref } from 'vue'\nimport { onLoad } from '@dcloudio/uni-app'\nimport { getHotRecommendApi } from '@/services/hot'\n\nconst props = defineProps<{\n  type: string\n}>()\n\n// 热门推荐页 标题和url\nconst hotMap = [\n  { type: '1', title: '特惠推荐', url: '/hot/preference' },\n  { type: '2', title: '爆款推荐', url: '/hot/inVogue' },\n  { type: '3', title: '一站买全', url: '/hot/oneStop' },\n  { type: '4', title: '新鲜好物', url: '/hot/new' },\n]\nconst activeIndex = ref(0)\nconst hotItem = hotMap.find((item) => item.type == props.type)\nuni.setNavigationBarTitle({ title: hotItem!.title })\n\nconst subTypes = ref<(SubTypes & { finish?: boolean })[]>()\nconst bannerPic = ref('')\nconst url = hotItem?.url!\nconst getHotRecommendData = async () => {\n  const { result } = await getHotRecommendApi<HotResult>(url, {\n    page: import.meta.env.DEV ? 30 : 0,\n  })\n  subTypes.value = result.subTypes\n  bannerPic.value = result.bannerPicture\n}\n\nconst onScrollToLower = async () => {\n  const currentSubTypes = subTypes.value![activeIndex.value]\n  if (currentSubTypes.goodsItems.page < currentSubTypes.goodsItems.pages) {\n    currentSubTypes.goodsItems.page++\n  } else {\n    currentSubTypes.finish = true\n    return\n  }\n  const { result } = await getHotRecommendApi<HotResult>(url, {\n    page: currentSubTypes.goodsItems.page,\n    pageSize: currentSubTypes.goodsItems.pageSize,\n    subType: currentSubTypes.id,\n  })\n  const newSubTypes = result.subTypes[activeIndex.value]\n  currentSubTypes.goodsItems.items.push(...newSubTypes.goodsItems.items)\n}\n\nonLoad(() => {\n  getHotRecommendData()\n})\n</script>\n\n<template>\n  <view class=\"viewport\">\n    <!-- 推荐封面图 -->\n    <view class=\"cover\">\n      <image :src=\"bannerPic\"></image>\n    </view>\n    <!-- 推荐选项 -->\n    <view class=\"tabs\">\n      <template v-for=\"(item, index) of subTypes\" :key=\"item.id\">\n        <text @tap=\"activeIndex = index\" class=\"text\" :class=\"{ active: index === activeIndex }\">\n          {{ item.title }}\n        </text>\n      </template>\n    </view>\n    <!-- 推荐列表 -->\n    <scroll-view scroll-y class=\"scroll-view\" @scrolltolower=\"onScrollToLower\">\n      <view class=\"goods\">\n        <navigator\n          hover-class=\"none\"\n          class=\"navigator\"\n          v-for=\"goods in subTypes![activeIndex].goodsItems.items\"\n          :key=\"goods\"\n          :url=\"`/pages/goods/goods?id=${goods.id}`\"\n        >\n          <image class=\"thumb\" :src=\"goods.picture\"></image>\n          <view class=\"name ellipsis\">{{ goods.name }}</view>\n          <view class=\"price\">\n            <text class=\"symbol\">¥</text>\n            <text class=\"number\">{{ goods.price }}</text>\n          </view>\n        </navigator>\n      </view>\n      <view class=\"loading-text\">{{\n        subTypes![activeIndex].finish ? '数据加载完毕~' : '正在加载...'\n      }}</view>\n    </scroll-view>\n  </view>\n</template>\n\n<style lang=\"scss\">\npage {\n  height: 100%;\n  background-color: #f4f4f4;\n}\n.viewport {\n  display: flex;\n  flex-direction: column;\n  height: 100%;\n  padding: 180rpx 0 0;\n  position: relative;\n}\n.cover {\n  width: 750rpx;\n  height: 225rpx;\n  border-radius: 0 0 40rpx 40rpx;\n  overflow: hidden;\n  position: absolute;\n  left: 0;\n  top: 0;\n}\n.scroll-view {\n  flex: 1;\n}\n.tabs {\n  display: flex;\n  justify-content: space-evenly;\n  height: 100rpx;\n  line-height: 90rpx;\n  margin: 0 20rpx;\n  font-size: 28rpx;\n  border-radius: 10rpx;\n  box-shadow: 0 4rpx 5rpx rgba(200, 200, 200, 0.3);\n  color: #333;\n  background-color: #fff;\n  position: relative;\n  z-index: 9;\n  .text {\n    margin: 0 20rpx;\n    position: relative;\n  }\n  .active {\n    &::after {\n      content: '';\n      width: 40rpx;\n      height: 4rpx;\n      transform: translate(-50%);\n      background-color: #27ba9b;\n      position: absolute;\n      left: 50%;\n      bottom: 24rpx;\n    }\n  }\n}\n.goods {\n  display: flex;\n  flex-wrap: wrap;\n  justify-content: space-between;\n  padding: 0 20rpx 20rpx;\n  .navigator {\n    width: 345rpx;\n    padding: 20rpx;\n    margin-top: 20rpx;\n    border-radius: 10rpx;\n    background-color: #fff;\n  }\n  .thumb {\n    width: 305rpx;\n    height: 305rpx;\n  }\n  .name {\n    height: 88rpx;\n    font-size: 26rpx;\n  }\n  .price {\n    line-height: 1;\n    color: #cf4444;\n    font-size: 30rpx;\n  }\n  .symbol {\n    font-size: 70%;\n  }\n  .decimal {\n    font-size: 70%;\n  }\n}\n\n.loading-text {\n  text-align: center;\n  font-size: 28rpx;\n  color: #666;\n  padding: 20rpx 0 50rpx;\n}\n</style>\n","import MiniProgramPage from 'D:/Arjence/学习/uniapp/heima-shop/src/pages/hot/hot.vue'\nwx.createPage(MiniProgramPage)"],"names":["ref","uni","getHotRecommendApi","onLoad"],"mappings":";;;;;;;;;;;;;AAYA,UAAM,SAAS;AAAA,MACb,EAAE,MAAM,KAAK,OAAO,QAAQ,KAAK,kBAAkB;AAAA,MACnD,EAAE,MAAM,KAAK,OAAO,QAAQ,KAAK,eAAe;AAAA,MAChD,EAAE,MAAM,KAAK,OAAO,QAAQ,KAAK,eAAe;AAAA,MAChD,EAAE,MAAM,KAAK,OAAO,QAAQ,KAAK,WAAW;AAAA,IAAA;AAExC,UAAA,cAAcA,kBAAI,CAAC;AACnB,UAAA,UAAU,OAAO,KAAK,CAAC,SAAS,KAAK,QAAQ,MAAM,IAAI;AAC7DC,kBAAA,MAAI,sBAAsB,EAAE,OAAO,QAAS,MAAO,CAAA;AAEnD,UAAM,WAAWD,cAAAA;AACX,UAAA,YAAYA,kBAAI,EAAE;AACxB,UAAM,MAAM,mCAAS;AACrB,UAAM,sBAAsB,YAAY;AACtC,YAAM,EAAE,OAAA,IAAW,MAAME,aAAAA,mBAA8B,KAAK;AAAA,QAC1D,MAA4B;AAAA,MAAK,CAClC;AACD,eAAS,QAAQ,OAAO;AACxB,gBAAU,QAAQ,OAAO;AAAA,IAAA;AAG3B,UAAM,kBAAkB,YAAY;AAClC,YAAM,kBAAkB,SAAS,MAAO,YAAY,KAAK;AACzD,UAAI,gBAAgB,WAAW,OAAO,gBAAgB,WAAW,OAAO;AACtE,wBAAgB,WAAW;AAAA,MAAA,OACtB;AACL,wBAAgB,SAAS;AACzB;AAAA,MACF;AACA,YAAM,EAAE,OAAA,IAAW,MAAMA,aAAAA,mBAA8B,KAAK;AAAA,QAC1D,MAAM,gBAAgB,WAAW;AAAA,QACjC,UAAU,gBAAgB,WAAW;AAAA,QACrC,SAAS,gBAAgB;AAAA,MAAA,CAC1B;AACD,YAAM,cAAc,OAAO,SAAS,YAAY,KAAK;AACrD,sBAAgB,WAAW,MAAM,KAAK,GAAG,YAAY,WAAW,KAAK;AAAA,IAAA;AAGvEC,kBAAAA,OAAO,MAAM;AACS;IAAA,CACrB;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACnDD,GAAG,WAAW,eAAe;"}