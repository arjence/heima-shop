{"version":3,"file":"index.js","sources":["../../../../src/services/index.ts"],"sourcesContent":["import { useMemberStore } from '@/stores'\n\ninterface Data<T> {\n  code: string\n  msg: string\n  result: T\n}\n\nclass Http {\n  baseURL: String = ''\n  constructor(baseURL: String) {\n    this.baseURL = baseURL\n  }\n\n  request<T>(options: UniApp.RequestOptions) {\n    //拼接url\n    options.url = this.baseURL + options.url\n    //请求超时时间\n    options.timeout = 10000\n    options.header = {\n      ...options.header,\n      'source-client': 'miniapp',\n    }\n    //设置token\n    const { profile } = useMemberStore()\n    const token = profile?.token\n    if (token) {\n      options.header.Authorization = token\n    }\n    return new Promise<Data<T>>((resolve, reject) => {\n      uni.request({\n        ...options,\n        success(res) {\n          if (res.statusCode >= 200 && res.statusCode < 300) {\n            resolve(res.data as Data<T>)\n          } else if (res.statusCode === 401) {\n            const store = useMemberStore()\n            store.clearProfile()\n            uni.navigateTo({\n              url: '/pages/login/login',\n            })\n          } else {\n            uni.showToast({\n              icon: 'none',\n              title: (res.data as Data<T>).msg || '数据获取失败',\n            })\n            reject(res)\n          }\n        },\n        fail: (err: any) => {\n          uni.showToast({\n            icon: 'none',\n            title: '网络错误，请切换网路！',\n          })\n          reject(err)\n        },\n      })\n    })\n  }\n\n  get<T = any>(options: any) {\n    return this.request<T>({ ...options, method: 'GET' })\n  }\n\n  post<T = any>(options: any) {\n    return this.request<T>({ ...options, method: 'POST' })\n  }\n}\n\nexport const http = new Http('https://pcapi-xiaotuxian-front-devtest.itheima.net')\n"],"names":["useMemberStore","uni"],"mappings":";;;;;;;;;;AAQA,MAAM,KAAK;AAAA,EAET,YAAY,SAAiB;AAD7B,mCAAkB;AAEhB,SAAK,UAAU;AAAA,EACjB;AAAA,EAEA,QAAW,SAAgC;AAEjC,YAAA,MAAM,KAAK,UAAU,QAAQ;AAErC,YAAQ,UAAU;AAClB,YAAQ,SAAS;AAAA,MACf,GAAG,QAAQ;AAAA,MACX,iBAAiB;AAAA,IAAA;AAGb,UAAA,EAAE,YAAYA,sBAAAA;AACpB,UAAM,QAAQ,mCAAS;AACvB,QAAI,OAAO;AACT,cAAQ,OAAO,gBAAgB;AAAA,IACjC;AACA,WAAO,IAAI,QAAiB,CAAC,SAAS,WAAW;AAC/CC,oBAAAA,MAAI,QAAQ;AAAA,QACV,GAAG;AAAA,QACH,QAAQ,KAAK;AACX,cAAI,IAAI,cAAc,OAAO,IAAI,aAAa,KAAK;AACjD,oBAAQ,IAAI,IAAe;AAAA,UAAA,WAClB,IAAI,eAAe,KAAK;AACjC,kBAAM,QAAQD,sBAAAA;AACd,kBAAM,aAAa;AACnBC,0BAAAA,MAAI,WAAW;AAAA,cACb,KAAK;AAAA,YAAA,CACN;AAAA,UAAA,OACI;AACLA,0BAAAA,MAAI,UAAU;AAAA,cACZ,MAAM;AAAA,cACN,OAAQ,IAAI,KAAiB,OAAO;AAAA,YAAA,CACrC;AACD,mBAAO,GAAG;AAAA,UACZ;AAAA,QACF;AAAA,QACA,MAAM,CAAC,QAAa;AAClBA,wBAAAA,MAAI,UAAU;AAAA,YACZ,MAAM;AAAA,YACN,OAAO;AAAA,UAAA,CACR;AACD,iBAAO,GAAG;AAAA,QACZ;AAAA,MAAA,CACD;AAAA,IAAA,CACF;AAAA,EACH;AAAA,EAEA,IAAa,SAAc;AACzB,WAAO,KAAK,QAAW,EAAE,GAAG,SAAS,QAAQ,OAAO;AAAA,EACtD;AAAA,EAEA,KAAc,SAAc;AAC1B,WAAO,KAAK,QAAW,EAAE,GAAG,SAAS,QAAQ,QAAQ;AAAA,EACvD;AACF;AAEa,MAAA,OAAO,IAAI,KAAK,oDAAoD;;"}